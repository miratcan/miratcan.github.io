{% extends "layout.html" %}
{% from "macros/article.html" import render_article %}

{% block title %}{{ this.title }}{% endblock %}
{% block og_type %}article{% endblock %}
{% block lang %}{{ this.language or 'en' }}{% endblock %}
{% block content_lang %}{{ this.language or 'en' }}{% endblock %}
{% block description %}{{ this.description|truncate(155) or this.body|striptags|truncate(155) }}{% endblock %}
{% block extra_head %}
  {% if this.has_code %}
    <link rel="stylesheet" href="{{ "static/pygments.css"|asseturl }}">
  {% endif %}
{% endblock %}
{% block jsonld %}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Article",
  "headline": {{ this.title|tojson }},
  "datePublished": "{{ this.pub_date }}",
  "author": {
    "@type": "Person",
    "name": "Mirat Can Bayrak",
    "url": "{{ config.PROJECT.url }}"
  },
  "publisher": {
    "@type": "Person",
    "name": "Mirat Can Bayrak"
  },
  "url": "{{ config.PROJECT.url }}{{ this._path }}/",
  "inLanguage": "{{ this.language or 'en' }}"
  {%- if this.meta_desc %},
  "description": {{ this.meta_desc|tojson }}
  {%- endif %}
  {%- if this.attachments.get('hero.png') or this.attachments.get('hero.jpg') %},
  "image": "{{ config.PROJECT.url }}{{ (this.attachments.get('hero.png') or this.attachments.get('hero.jpg')).url_path }}"
  {%- endif %}
}
</script>
{% endblock %}
{% block meta_img %}{% if this.attachments.get('hero.png') %}{{ this.attachments.get('hero.png').path}}{% endif %}{% if this.attachments.get('hero.jpg') %}{{ this.attachments.get('hero.jpg').path}}{% endif %}{% endblock %}

{% block body %}
{% if 'quote' in this.tags %}
<div class="quote-post">
  <blockquote>
    {{ this.body }}
  </blockquote>
</div>
{% elif 'video' in this.tags %}
<div class="video-post">
  {{ this.body }}
</div>
{% elif 'photo' in this.tags %}
<div class="photo-post">
  <div class="photo-post-images">
    {% for attachment in this.attachments.images %}
      {% if not attachment.attachment_filename.startswith('hero') %}
      <img src="{{ attachment|url }}" alt="{{ this.title }}" loading="lazy">
      {% endif %}
    {% endfor %}
  </div>
  {% if this.body %}
  <div class="photo-post-body">
    {{ this.body }}
  </div>
  {% endif %}
</div>
{% else %}
{% if this.is_archived %}
<div style="background: color-mix(in srgb, var(--accent) 15%, transparent); border: 1px solid color-mix(in srgb, var(--accent) 30%, transparent); border-radius: var(--radius); padding: 1rem 1.3rem; margin-bottom: 2rem;">
  <p style="margin: 0; color: var(--fg);"><strong>‚ö†Ô∏è Archived Article:</strong> This article is very old and may contain outdated or incorrect information. It's kept here for nostalgic and historical reasons.</p>
</div>
{% endif %}
{% if this.language == 'tr' %}
<div style="background: color-mix(in srgb, var(--accent) 15%, transparent); border: 1px solid color-mix(in srgb, var(--accent) 30%, transparent); border-radius: var(--radius); padding: 1rem 1.3rem; margin-bottom: 2rem;">
  <p style="margin: 0; color: var(--fg);"><strong>üáπüá∑ Turkish Content:</strong> This article is written in Turkish. The cultural and emotional nuances cannot be properly translated, so it remains in its original language.</p>
</div>
{% endif %}
{{ render_article(this) }}
{% if this.tags %}
  <ul>
    {% for t in this.tags -%}
      <li>
        <a href="{{ ('/articles@tag/' ~ t)|url }}">
          All posts tagged {{ t }}
        </a>
      </li>
    {% endfor %}
  </ul>
{% endif %}
{% endif %}

{% endblock %}
{% block after_screen %}
{% if 'quote' not in this.tags and 'photo' not in this.tags and 'video' not in this.tags %}
<script src="https://utteranc.es/client.js"
        repo="miratcan/miratcan.github.io"
        issue-term="title"
        label="Comment"
        theme="github-dark"
        crossorigin="anonymous"
        async>
</script>
{% endif %}
{% endblock %}
